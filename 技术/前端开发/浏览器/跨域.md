---
aliases: [跨域, 同源策略网络, 浏览器跨域]
tags: [浏览器跨域]
date created: 2022-06-20 21:17:45
date updated: 2023-03-08 03:26:57
title: 跨域
---

# 跨域

跨域是指浏览器的同源策略限制了不同源的文档或脚本如何来进行通信。它是浏览器最核心也是最基本的安全功能，用于隔离潜在恶意的文档，减少可能被攻击的媒介。

## 同源策略

| 说明           | 是否允许通讯 | URL 示例 |
| ------------ | ------ | ---- |
| 同一域名，不同文件或路径 | 允许     |   <http://www.example.com/one.html> <br> <http://www.example.com/two.html> |
| 同一域名，不同端口    | 不允许    |  <http://www.example.com:8080/> <br> <http://www.example.com:8081/> |
| 同一域名，不同协议    | 不允许    | <http://www.example.com/> <br> <https://www.example.com/> |
| 域名和域名对应 ip   | 不允许    |  <http://www.example.com/> <br> <http://127.0.0.1/> |
| 域相同，子域不同     | 不允许    | <http://www.example.com/> <br> <http://subdomain.example.com/> |
| 不同域名         | 不允许    | <http://www.example.com/> <br> <http://www.example.org/> |

## 跨域方式

### localStorage、sessionStorage、cookie、indexDB

这些方式都是同源策略的例外，因为它们是在浏览器端存储数据的方式，不涉及到跨域通信。

### webSocket

WebSocket 是一种在单个 TCP 连接上进行全双工通信的协议。它实现了浏览器与服务器全双工通信，允许服务端主动向客户端推送信息。同时它也是跨域通信的一种方式。

### postMessage

postMessage 是 HTML5 中新增的 API，它可以实现跨窗口通信，即不同源的两个页面可以进行通信。它的基本思想是，如果你获得了某个窗口的 window 对象的引用，就可以向它发送消息，反之亦然。

### CORS

CORS 是 W3C 标准，全称是"跨域资源共享"（Cross-origin resource sharing）。它允许浏览器向跨源服务器，发出 XMLHttpRequest 请求，从而克服了 AJAX 只能同源使用的限制。

### JSONP

JSONP 是 JSON with Padding 的缩写，它是一种常见的跨域通信方式。它的基本思想是，网页通过添加一个`<script>`元素，向服务器请求 JSON 数据，这种做法不受同源策略限制。服务器收到请求后，将数据放在一个指定名字的回调函数里传回来。

### document.domain + iframe

document.domain + iframe 是一种常见的跨域通信方式。它的基本思想是，将两个不同源的页面都设置为同一个域名下的子域，从而实现跨域通信。

### location.hash + iframe

 a.html 欲与c.html 跨域相互通信，通过中间页b.html 来实现。三个页面，不同域之间利用 iframe 的 location.hash 传值，相同域之间直接 js 访问来通信。

### window.name + iframe

window.name属性的独特之处：name值在不同的页面（甚至不同域名）加载后依旧存在，并且可以支持非常长的 name 值（2MB）。

### 代理服务器

一般用于开发环境，通过代理服务器来转发请求，从而实现跨域通信。

## 关联

- [九种跨域方式实现原理（完整版） - 掘金](https://juejin.cn/post/6844903767226351623)
